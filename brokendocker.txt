FROM mcr.microsoft.com/devcontainers/python:0-3.11

COPY ca_bundle.crt /usr/local/share/ca-certificates
COPY ca_bundle.pem /usr/local/share/ca-certificates
RUN update-ca-certificates

ENV HTTP_PROXY="http://web.prod.proxy.cargill.com:4300"
ENV HTTPS_PROXY="https://web.prod.proxy.cargill.com:4300" 
ENV NO_PROXY="*.cargill.com,127.0.0.0/8" 

COPY requirements.txt /tmp/pip-tmp/
RUN pip3 \
  --disable-pip-version-check \
  --trusted-host pypi.python.org \
  --cert /usr/local/share/ca-certificates/ca_bundle.pem \
  --no-cache-dir install -r /tmp/pip-tmp/requirements.txt \
  && rm -rf /tmp/pip-tmp

WORKDIR /app
COPY app/ ./

EXPOSE 8000
ENTRYPOINT [ "uvicorn", "--reload", "--host", "0.0.0.0", "fastapi_server:app" ]
---
 => ERROR [6/8] RUN pip3   --disable-pip-version-check   --trusted-host pypi.python.org   --cert /usr/local/share/ca-certificates/ca_bundle.pem   --no-cache-dir install -r /tmp/pip-tmp/requirements.txt   &&  26.2s 
------
 > [6/8] RUN pip3   --disable-pip-version-check   --trusted-host pypi.python.org   --cert /usr/local/share/ca-certificates/ca_bundle.pem   --no-cache-dir install -r /tmp/pip-tmp/requirements.txt   && rm -rf /tmp/pip-tmp:
#0 9.347 WARNING: Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ProxyError('Your proxy appears to only use HTTP and not HTTPS, try changing your proxy URL to be HTTP. See: https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#https-proxy-error-http-proxy', SSLError(SSLError(1, '[SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1002)')))': /simple/llama-cpp-python/
#0 10.06 WARNING: Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ProxyError('Your proxy appears to only use HTTP and not HTTPS, try changing your proxy URL to be HTTP. See: https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#https-proxy-error-http-proxy', SSLError(SSLError(1, '[SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1002)')))': /simple/llama-cpp-python/
#0 11.28 WARNING: Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ProxyError('Your proxy appears to only use HTTP and not HTTPS, try changing your proxy URL to be HTTP. See: https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#https-proxy-error-http-proxy', SSLError(SSLError(1, '[SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1002)')))': /simple/llama-cpp-python/
#0 13.49 WARNING: Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ProxyError('Your proxy appears to only use HTTP and not HTTPS, try changing your proxy URL to be HTTP. See: https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#https-proxy-error-http-proxy', SSLError(SSLError(1, '[SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1002)')))': /simple/llama-cpp-python/
#0 17.70 WARNING: Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'ProxyError('Your proxy appears to only use HTTP and not HTTPS, try changing your proxy URL to be HTTP. See: https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#https-proxy-error-http-proxy', SSLError(SSLError(1, '[SSL: WRONG_VERSION_NUMBER] wrong version number (_ssl.c:1002)')))': /simple/llama-cpp-python/
#0 26.05 ERROR: Could not find a version that satisfies the requirement llama-cpp-python (from versions: none)
#0 26.05 ERROR: No matching distribution found for llama-cpp-python
------
failed to solve: executor failed running [/bin/sh -c pip3   --disable-pip-version-check   --trusted-host pypi.python.org   --cert /usr/local/share/ca-certificates/ca_bundle.pem   --no-cache-dir install -r /tmp/pip-tmp/requirements.txt   && rm -rf /tmp/pip-tmp]: exit code: 1

 *  The terminal process "C:\WINDOWS\System32\WindowsPowerShell\v1.0\powershell.exe -Command docker compose -f "docker-compose.yml" up -d --build" terminated with exit code: 1. 
 *  Terminal will be reused by tasks, press any key to close it. 
